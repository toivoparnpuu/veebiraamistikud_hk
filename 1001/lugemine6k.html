<!doctype html>
<html>
  <head>
    <title>Reacti katsetused</title>
	<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
	<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  </head>
  <body>
    <div id="kiht1"></div>	
  </body>
  <script type="text/babel">
    function Kuvamine(){
	    const [aadress, muudaAadress]=React.useState("teade1.txt");
	    const [aadressid, muudaAadressid]=React.useState([]);
	    const [teade, muudaTeade]=React.useState("abcd");
		const [sisestus, muudaSisestus]=React.useState("a");
		
        function ava(aadress){
		   fetch(aadress).then(d => d.text()).then(t => muudaTeade(t));
		}
        
        function lisa(){
		   fetch("lisateade.php?teade="+encodeURIComponent(sisestus)).then(() => {muudaSisestus(""); loeAadressid();});
		}
        
        function loeAadressid(){
  		  fetch("teated.php").then(d => d.json()).
		      then(j => muudaAadressid(j));			
		}		
		
        React.useEffect(() => {  
		  loeAadressid();
		}, []);
		
        React.useEffect(() => {
		   ava(aadress);
		}, [aadress]);
	    
        const nupud=aadressid.map(aadress =>
		  <input type="button" value={aadress} key={aadress}
  		    onClick={() => muudaAadress(aadress) }/>)
	    return <div>{teade} {aadress}<br /> {nupud}<br />
		   <input type="text" value={sisestus} 
		     onChange={(e) => muudaSisestus(e.target.value)} />
		   <input type="button" value="Lisa teade"
  		      onClick={() => lisa()} />
		</div>;
	}
	const root= ReactDOM.createRoot(document.getElementById("kiht1"))
	root.render(<Kuvamine />)
  </script>
</html>
